{"version":3,"sources":["assets/scripts/Game.js"],"names":["cc","Class","Component","properties","starPrefab","type","Prefab","maxStartDuration","minStartDuration","groud","Node","player","scoreDisplay","Label","scoreAudio","AudioClip","onLoad","score","groudY","y","height","timer","startDuration","spawnNewStar","newStar","instantiate","getComponent","game","node","addChild","setPosition","getNewStarPosition","Math","random","randX","randY","jumpHeight","maxX","width","v2","start","gainScore","string","audioEngine","playEffect","gameOver","stopAllActions","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        starPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        maxStartDuration: 0,\n        minStartDuration: 0,\n\n        groud: {\n            default: null,\n            type: cc.Node\n        },\n        player: {\n            default: null,\n            type: cc.Node\n        },\n        scoreDisplay: {\n            default: null,\n            type: cc.Label\n        },\n        scoreAudio: {\n            default: null,\n            type: cc.AudioClip\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.score = 0\n        this.groudY = this.groud.y + this.groud.height/2\n        this.timer = 0\n        this.startDuration = 0\n        this.spawnNewStar()\n        this.score = 0\n    },\n    spawnNewStar(){\n        let newStar = cc.instantiate(this.starPrefab)\n        newStar.getComponent('Star').game = this\n        this.node.addChild(newStar)\n\n        newStar.setPosition(this.getNewStarPosition())\n        this.startDuration = this.minStartDuration + Math.random() * (this.maxStartDuration - this.minStartDuration)\n        this.timer = 0\n0    },\n    getNewStarPosition(){\n        let randX = 0\n\n        let randY = this.groudY + Math.random * this.player.getComponent('Player').jumpHeight + 50\n\n        let maxX = this.node.width / 2\n\n        randX = (Math.random() - 0.5) *2 *maxX\n        return cc.v2(randX, randY)\n    },\n    start () {\n\n    },\n    gainScore () {\n        this.score += 1;\n        // 更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = 'Score: ' + this.score\n\n        cc.audioEngine.playEffect(this.scoreAudio, false)\n    },\n    gameOver(){\n      this.player.stopAllActions()\n      // cc.director.loadScene('game')\n    },\n    update (dt) {\n        if (this.timer > this.startDuration){\n            this.gameOver()\n            return\n        }\n        this.timer += dt\n    },\n});\n"]}